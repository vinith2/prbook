
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Filtering &#8212; Pattern Recognition</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"vect": ["\\boldsymbol{#1}", 1], "mat": ["\\boldsymbol{#1}", 1], "rvar": ["\\mathsf{#1}", 1], "rvect": ["\\mathsf{\\boldsymbol{#1}}", 1], "rmat": ["\\mathsf{\\boldsymbol{#1}}", 1], "vx": ["\\vect{x}"], "vy": ["\\vect{y}"], "vz": ["\\vect{z}"], "vv": ["\\vect{v}"], "vw": ["\\vect{w}"], "va": ["\\vect{a}"], "vb": ["\\vect{b}"], "vc": ["\\vect{c}"], "vd": ["\\vect{d}"], "ve": ["\\vect{e}"], "vf": ["\\vect{f}"], "vg": ["\\vect{g}"], "vh": ["\\vect{h}"], "vk": ["\\vect{k}"], "vp": ["\\vect{p}"], "vn": ["\\vect{n}"], "vell": ["\\vect{\\ell}"], "vmu": ["\\vect{\\mu}"], "mX": ["\\mat{X}"], "mY": ["\\mat{Y}"], "mZ": ["\\mat{Z}"], "mV": ["\\mat{V}"], "mW": ["\\mat{W}"], "mA": ["\\mat{A}"], "mB": ["\\mat{B}"], "mC": ["\\mat{C}"], "mD": ["\\mat{D}"], "mE": ["\\mat{E}"], "mF": ["\\mat{F}"], "mG": ["\\mat{G}"], "mH": ["\\mat{H}"], "mK": ["\\mat{K}"], "mP": ["\\mat{P}"], "mSigma": ["\\mat{\\Sigma}"], "mI": ["\\mat{I}"], "rx": ["\\rvar{x}"], "ry": ["\\rvar{y}"], "rz": ["\\rvar{z}"], "rv": ["\\rvar{v}"], "rw": ["\\rvar{w}"], "ra": ["\\rvar{a}"], "rb": ["\\rvar{b}"], "rc": ["\\rvar{c}"], "rd": ["\\rvar{d}"], "re": ["\\rvar{e}"], "rf": ["\\rvar{f}"], "rg": ["\\rvar{g}"], "rh": ["\\rvar{h}"], "rk": ["\\rvar{k}"], "rp": ["\\rvar{p}"], "rX": ["\\rvar{X}"], "rH": ["\\rvar{H}"], "rY": ["\\rvar{Y}"], "rvx": ["\\rvect{x}"], "rvy": ["\\rvect{y}"], "rvz": ["\\rvect{z}"], "rvv": ["\\rvect{v}"], "rvw": ["\\rvect{w}"], "rva": ["\\rvect{a}"], "rvb": ["\\rvect{b}"], "rvc": ["\\rvect{c}"], "rvd": ["\\rvect{d}"], "rve": ["\\rvect{e}"], "rvf": ["\\rvect{f}"], "rvg": ["\\rvect{g}"], "rvh": ["\\rvect{h}"], "rvk": ["\\rvect{k}"], "rvp": ["\\rvect{p}"], "rmX": ["\\rmat{X}"], "rmY": ["\\rmat{Y}"], "rmZ": ["\\rmat{Z}"], "rmV": ["\\rmat{V}"], "rmW": ["\\rmat{W}"], "rmA": ["\\rmat{A}"], "rmB": ["\\rmat{B}"], "rmC": ["\\rmat{C}"], "rmD": ["\\rmat{D}"], "rmE": ["\\rmat{E}"], "rmF": ["\\rmat{F}"], "rmG": ["\\rmat{G}"], "rmH": ["\\rmat{H}"], "rmK": ["\\rmat{K}"], "rmP": ["\\rmat{P}"], "EE": ["\\mathbb{E}"], "RR": ["\\mathbb{R}"], "CC": ["\\mathbb{C}"], "ZZ": ["\\mathbb{Z}"], "SS": ["\\mathbb{S}"], "norm": ["\\|#1\\|", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Denoising and deblurring" href="denoise-deblur.html" />
    <link rel="prev" title="Modeling Knowledge" href="modeling-knowledge.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo_sada-lab_black.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Pattern Recognition</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="installation.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="introduction.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="modeling-knowledge.html">
   Modeling Knowledge
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Filtering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="denoise-deblur.html">
   Denoising and deblurring
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/filtering.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Ffiltering.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/filtering.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download notebook file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-code"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        <a href="_sources/filtering.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discrete-fourier-transform">
   Discrete Fourier Transform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#an-alternative-view-of-the-dft">
   An alternative view of the DFT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implicit-periodization">
   Implicit periodization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#circular-convolution">
   Circular convolution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-vs-circular-convolution">
   Linear vs circular convolution
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Filtering</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discrete-fourier-transform">
   Discrete Fourier Transform
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#an-alternative-view-of-the-dft">
   An alternative view of the DFT
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implicit-periodization">
   Implicit periodization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#circular-convolution">
   Circular convolution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-vs-circular-convolution">
   Linear vs circular convolution
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="filtering">
<h1>Filtering<a class="headerlink" href="#filtering" title="Permalink to this headline">#</a></h1>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>import numpy as np
import matplotlib.pyplot as plt
import matplotlib as mpl
from tqdm import tqdm

mpl.rcParams[&#39;axes.spines.top&#39;] = 0
mpl.rcParams[&#39;axes.spines.right&#39;] = 0
mpl.rcParams[&#39;axes.spines.left&#39;] = 1
mpl.rcParams[&#39;axes.spines.bottom&#39;] = 1
mpl.rcParams.update({&#39;font.size&#39;: 12})
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.spines.top&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.spines.right&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;tqdm&#39;
</pre></div>
</div>
</div>
</div>
<section id="discrete-fourier-transform">
<h2>Discrete Fourier Transform<a class="headerlink" href="#discrete-fourier-transform" title="Permalink to this headline">#</a></h2>
<p>We have seen that the discrete-time Fourier transform (or discrete-space Fourier transform) is a great tool to understand linear shift-invariant filtering of discrete signal and imaging. On the other hand, it is clear that in a computer we will only ever deal with finite-length signals, and in the case of images, often standardized dimensions. It is natural to ask whether there exists a tool similar to DTFT that is tailor-made for finite-length (finite-support) signals. This is also related to the fact that the frequency <span class="math notranslate nohighlight">\(\omega\)</span> in DTFT is continuous: there are uncountably many possible values that it can take between <span class="math notranslate nohighlight">\(-\pi\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span>. But if our images are of size <span class="math notranslate nohighlight">\(64 \times 64 = 4096\)</span> then we know that we can choose a 4096-dimensional basis to represent any image as a superposition of elements in that basis. It thus seems wasteful to use superpositions of an uncountable infinity complex exponentials with different frequency to represent such images.<a class="footnote-reference brackets" href="#id3" id="id1">1</a></p>
<p>We’d like to have a Fourier transform for finite-length signals (say of length <span class="math notranslate nohighlight">\(N\)</span>), which requires only <span class="math notranslate nohighlight">\(N\)</span> basis functions, or <span class="math notranslate nohighlight">\(N\)</span> frequencies. A natural way to do that is to subdivide <span class="math notranslate nohighlight">\([-\pi, \pi)\)</span> into <span class="math notranslate nohighlight">\(N\)</span> intervals of equal length, that is to say, choose the sinusoids with discretized frequencies</p>
<div class="math notranslate nohighlight">
\[
  \omega_k = \frac{2\pi}{N}k, \ \text{for} \ k \in \{ 0, 1, \ldots, N - 1 \}.
\]</div>
<p>The corresponding base complex exponentials are the roots of unity. That is, <span class="math notranslate nohighlight">\(e^{i \omega_k}\)</span> are the solutions to</p>
<div class="math notranslate nohighlight">
\[
  z^N = 1,
\]</div>
<p>equally spaced on the unit circle. Here is an illustration for <span class="math notranslate nohighlight">\(N = 8\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>N = 8
angles = np.linspace(0, 2*np.pi, 128, endpoint=True)
root_angles = 2 * np.pi / N * np.arange(N)
fig, ax = plt.subplots(1, 1, figsize=(8, 8))

ax.spines[[&#39;left&#39;, &#39;bottom&#39;]].set_position(&#39;center&#39;)
ax.spines[[&#39;right&#39;, &#39;top&#39;]].set_color(&#39;none&#39;)
ax.xaxis.set_ticks_position(&#39;bottom&#39;)
ax.yaxis.set_ticks_position(&#39;left&#39;)

ax.plot(np.cos(angles), np.sin(angles))
ax.plot(np.cos(root_angles), np.sin(root_angles), &#39;o&#39;, markersize=20)
ax.set_aspect(1)
</pre></div>
</div>
</div>
</div>
<p>It turns out that such sinusoids are orthogonal. Indeed, denoting <span class="math notranslate nohighlight">\(\nu_{k}[n] = e^{i \omega_k n}\)</span>, we get that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  \langle \nu_k, \nu_\ell \rangle 
  &amp;= \sum_{n = 0}^{N - 1} \nu_k[n] \nu_\ell[n] \\
  &amp;= \sum_{n = 0}^{N - 1} e^{i \omega_k n} e^{-i \omega_\ell n} \\
  &amp;= \sum_{n = 0}^{N - 1} e^{i \frac{2\pi n}{N} (k - \ell) } \\
  &amp;= (\ast)
\end{aligned}
\end{split}\]</div>
<p>If <span class="math notranslate nohighlight">\(k = \ell\)</span> the exponent is zero and the result is simply <span class="math notranslate nohighlight">\(N\)</span>. To make progress for <span class="math notranslate nohighlight">\(k \neq \ell\)</span> we recall the formula for partial sums of a geometric series,</p>
<div class="math notranslate nohighlight">
\[
  \sum_{n = 0}^{N - 1} a^n = \frac{1 - a^N}{1 - a}.
\]</div>
<p>Applying the formula with <span class="math notranslate nohighlight">\(a = e^{i \frac{2 \pi (k - \ell)}{N}}\)</span> we get that</p>
<div class="math notranslate nohighlight">
\[
  (\ast) 
  = \frac{1 - (e^{i \frac{2 \pi (k - \ell)}{N}})^N} {1 - e^{i \frac{2 \pi (k - \ell)}{N}}}
\]</div>
<p>Now since <span class="math notranslate nohighlight">\((e^{i \frac{2 \pi (k - \ell)}{N}})^N = e^{i 2 \pi (k - \ell)} = 1\)</span> (recall that the complex exponential is <span class="math notranslate nohighlight">\(2\pi\)</span>-periodic, we see that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
   \langle \nu_k, \nu_\ell \rangle 
   =
   \begin{cases}
      N &amp; k = \ell \\
      0 &amp; k \neq \ell.
   \end{cases}
\end{split}\]</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Write a code snippet to test this orthogonality numerically.</p>
</div>
<p>This finally allows us to define the forward and the inverse discrete Fourier transform (DFT) as</p>
<div class="math notranslate nohighlight">
\[
  X[k] = \sum_{n = 0}^{N - 1} x[n] e^{-i \frac{2\pi}{N} nk}
  \quad
  \longleftrightarrow
  \quad
  x[n] = \frac{1}{N} \sum_{k = 0}^{N - 1} X[k] e^{i \frac{2\pi}{N} kn}.
\]</div>
</section>
<section id="an-alternative-view-of-the-dft">
<h2>An alternative view of the DFT<a class="headerlink" href="#an-alternative-view-of-the-dft" title="Permalink to this headline">#</a></h2>
<p>Is there an alternative intuitive derivation of the DFT? Sure there is! We can obtain it as a limit DTFT for periodized signals. The math gets a bit involved, especially if you want to do it carefully, so we won’t go into the details. But we can write some code. We begin with a simple triangular pulse of <span class="math notranslate nohighlight">\(L\)</span> samples:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>L = 31
n_pulse = np.arange(1 + 2*L)
x = (L - np.abs(n_pulse - L)) / L
x -= x.mean()
plt.plot(n_pulse, x, &#39;.&#39;);
</pre></div>
</div>
</div>
</div>
<p>Assuming that this pulse is extended by zeros to both infinities we can plot its DTFT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>from scipy.signal import freqz

omega, X = freqz(x)
plt.plot(omega, np.abs(X))
plt.xlabel(&#39;$\\omega$&#39;)
plt.ylabel(&#39;$X(\\omega)$&#39;);
</pre></div>
</div>
</div>
</div>
<p>(We are only showing the spectral magnitude for frequencies <span class="math notranslate nohighlight">\(\omega \in [0, \pi)\)</span> since for real-valued signals <span class="math notranslate nohighlight">\(x[n]\)</span> we have that <span class="math notranslate nohighlight">\(X(-\omega) = X(\omega)^\ast\)</span> so that <span class="math notranslate nohighlight">\(|X(-\omega)| = |X(\omega)|\)</span>.)</p>
<p>We now construct a <em>periodic extension</em> <span class="math notranslate nohighlight">\(\tilde{x}[n]\)</span> of <span class="math notranslate nohighlight">\(x[n]\)</span> by repeating <span class="math notranslate nohighlight">\(x[n]\)</span> a number of times, and compute its DTFT:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>R_list = [2, 5, 1000] # number of repetitions

fig, axs = plt.subplots(2, 3, figsize=(12, 6))
for i_R, R in enumerate(R_list):
  x_tilde = np.tile(x, R)
  omega, X_tilde = freqz(x_tilde)
  axs[0, i_R].plot(np.arange(len(x_tilde)), x_tilde)
  axs[1, i_R].plot(omega, np.abs(X_tilde))
  axs[1, i_R].set_ylim(0, 50)
</pre></div>
</div>
</div>
</div>
<p>We see that the more periodic repetitions we make, the more discrete the spectrum becomes! With a bit more work we could prove that the spacing between the spectral lines is exactly <span class="math notranslate nohighlight">\(2\pi\)</span> divided by the number of samples in one period. (For ease of visualization we plotted the signals as if they were continuous, but they are discrete.)</p>
</section>
<section id="implicit-periodization">
<h2>Implicit periodization<a class="headerlink" href="#implicit-periodization" title="Permalink to this headline">#</a></h2>
<p>From the definition of the DFT and the above discussion, we see that the DFT implicitly periodizes the finite-length signals. The expression for the inverse transform,</p>
<div class="math notranslate nohighlight">
\[
  x[n] = \frac{1}{N} \sum_{k = 0}^{N - 1} X[k] e^{i \frac{2\pi k}{N} n},
\]</div>
<p>should a priori only make sense for those <span class="math notranslate nohighlight">\(n\)</span> where the signal is defined, namely from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(N - 1\)</span>. But there is nothing preventing us from evaluating it elsewhere, whence it indeed follows that</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
  x[n + N]
  &amp;= \frac{1}{N} \sum_{k = 0}^{N - 1} X[k] e^{i \frac{2\pi k}{N} (n + N)} \\
  &amp;= \frac{1}{N} \sum_{k = 0}^{N - 1} X[k] e^{i \frac{2\pi k}{N} n} e^{i \frac{2\pi k}{N} N} \\
  &amp;= \frac{1}{N} \sum_{k = 0}^{N - 1} X[k] e^{i \frac{2\pi k}{N} n}.
\end{aligned}
\end{split}\]</div>
<p>Thus with the DFT both the spectrum <span class="math notranslate nohighlight">\(X[k]\)</span> and the signal <span class="math notranslate nohighlight">\(x[n]\)</span> are implicitly periodic.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>(Warning: puritanism) Strictly speaking we should not use <span class="math notranslate nohighlight">\(x[n]\)</span> in the above expression since our starting <span class="math notranslate nohighlight">\(x[n]\)</span> is only defined for <span class="math notranslate nohighlight">\(n \in \{ 0, \ldots, N - 1\}\)</span>. The inverse DFT agrees with <span class="math notranslate nohighlight">\(x[n]\)</span> on this interval but is also defined everywhere else.</p>
</div>
</section>
<section id="circular-convolution">
<h2>Circular convolution<a class="headerlink" href="#circular-convolution" title="Permalink to this headline">#</a></h2>
<p>We’ve seen that the DTFT gives us a nice and useful interpretation of convolution in the frequency domain. Do we get the same with the DFT? Well… almost. Since DFT implicitly treats the signals as periodic we have to replace our old definition of convolution by the so-called circular convolution. This just means that when we run out of indices, we wrap around back to the beginning. We’ll use the following convenient modulo notation,</p>
<div class="math notranslate nohighlight">
\[
  (n)_N = n - N \lfloor n / N \rfloor
\]</div>
<p>which is just the usual modulo-<span class="math notranslate nohighlight">\(N\)</span> division. For example, <span class="math notranslate nohighlight">\((7)_8 = 7\)</span>, <span class="math notranslate nohighlight">\((8)_8 = 0\)</span>, <span class="math notranslate nohighlight">\((9)_8 = 1\)</span>.</p>
<p>This yields the definition</p>
<div class="math notranslate nohighlight">
\[
  (x \circledast_N h)[n] = \sum_{m = 0}^{N - 1} x[m] h[(n - m)_N].
\]</div>
<p>We will omit the subscript <span class="math notranslate nohighlight">\(N\)</span> in <span class="math notranslate nohighlight">\(\circledast_N\)</span> when it is clear from context.</p>
<p>With this definition it is not hard to show (do it for fun!) that if <span class="math notranslate nohighlight">\(y = x \circledast h\)</span> and <span class="math notranslate nohighlight">\(X[k]\)</span>, <span class="math notranslate nohighlight">\(H[k]\)</span>, and <span class="math notranslate nohighlight">\(Y[k]\)</span> are the DFTs of <span class="math notranslate nohighlight">\(x[n]\)</span>, <span class="math notranslate nohighlight">\(h[n]\)</span>, and <span class="math notranslate nohighlight">\(y[n]\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
  Y[k] = X[k] H[k].
\]</div>
<p>Conversely, multiplying DFTs of two sequences corresponds to their circular convolution in time (or space when we work with images). This is very important to remember. Unlike forward and inverse DTFT which can only be approximated in a computer by finely discetizing the frequency <span class="math notranslate nohighlight">\(\omega\)</span>, DFT can be implemented exactly (if we ignore the detail that we cannot represent real numbers with infinite precision). What is more, there exists a very efficient algorithm to compute the DFT of a sequence of length <span class="math notranslate nohighlight">\(N\)</span>. Naive computation requires to perform a number of operations roughtly proportional to <span class="math notranslate nohighlight">\(N^2\)</span>. This is because we want to compute <span class="math notranslate nohighlight">\(X[k]\)</span> for <span class="math notranslate nohighlight">\(N\)</span> different values of <span class="math notranslate nohighlight">\(k\)</span>, and for each <span class="math notranslate nohighlight">\(k\)</span> we have to perform <span class="math notranslate nohighlight">\(N\)</span> complex multiplications and sum the results. But the infamous fast Fourier transfrom (FFT) only needs a number of operations proportional to <span class="math notranslate nohighlight">\(N \log_2 N\)</span>. That is an enormous saving. For <span class="math notranslate nohighlight">\(N = 4096\)</span>, <span class="math notranslate nohighlight">\(N^2 = 16,777,216\)</span> but <span class="math notranslate nohighlight">\(N \log_2 N = 49,152\)</span>. It is hard to overstate the importance of the FFT in ushering in and maintaining the digital era. This importance stems from the importance of filtering and computing convolutions. Just like naively computing the DFT, naively computing the (circular) convolution takes about <span class="math notranslate nohighlight">\(N^2\)</span> operations. But consider this crazy idea: why not first transform both sequences we want to convolve using the FFT (<span class="math notranslate nohighlight">\(2 \times N \log N\)</span>) then compute the convolution in the DFT domain, which is just multiplication for every <span class="math notranslate nohighlight">\(k\)</span> (<span class="math notranslate nohighlight">\(N\)</span>) and then transform the result back to the time (space) domain (<span class="math notranslate nohighlight">\(N \log N\)</span>). The overall cost of this dance scales as <span class="math notranslate nohighlight">\(N \log N\)</span> and becomes preferable to the direct calculation already for relatively small <span class="math notranslate nohighlight">\(N\)</span>.</p>
</section>
<section id="linear-vs-circular-convolution">
<h2>Linear vs circular convolution<a class="headerlink" href="#linear-vs-circular-convolution" title="Permalink to this headline">#</a></h2>
<p>But there is a catch: we almost always want to compute or old <em>linear</em><a class="footnote-reference brackets" href="#id4" id="id2">2</a> convolution, not circular. Reverberation in a cathedral is not a cricular phenomenon. We need a way to use the described excursion via the FFT to <em>emulate</em> linear convolution.</p>
<p>Luckily, this is not hard. The idea is to pad the signal with zeros so that the modulo formula does not have to “wrap around”. To see how, let again <span class="math notranslate nohighlight">\(x[n]\)</span> be a signal of length <span class="math notranslate nohighlight">\(N\)</span>, and <span class="math notranslate nohighlight">\(h[n]\)</span> a “filter” of length <span class="math notranslate nohighlight">\(N\)</span>. Now recall that the convolution of signals of length <span class="math notranslate nohighlight">\(N\)</span> and <span class="math notranslate nohighlight">\(L\)</span> has length <span class="math notranslate nohighlight">\(N + L - 1\)</span>. We thus define a zero-padded version of <span class="math notranslate nohighlight">\(x\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  x_{\text{ZP}}[n] 
  = 
  \begin{cases}
    x[n] &amp; n \in \{0, 1, \ldots, N - 1\} \\
    0    &amp; n \in \{N, N + 1, \ldots, 2N - 1\}.
  \end{cases}
\end{split}\]</div>
<p>It then follows that</p>
<div class="math notranslate nohighlight">
\[  
  (x_{\text{ZP}} \circledast_N h)[n] = (x \ast h)[n], \quad \text{for}~n \in \{0, 1, \ldots, 2N - 1\}.
\]</div>
<p>Zero padding is part of the broader theme of properly handling boundary conditions in convolution.</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>This is even true for infinite-support discrete time/space signals. Since they are indexed by integers <span class="math notranslate nohighlight">\(\mathbb{Z}\)</span> or pairs of integers <span class="math notranslate nohighlight">\(\mathbb{Z}^2\)</span>, they are countable, and thus spanned by bases with much fewer elements than the interval <span class="math notranslate nohighlight">\([-\pi, \pi)\)</span> which has as many elements as the real line.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Here, <em>linear</em> is not meant in the sense of a linear system, but in the sense of not being circular. Both “linear” and circular convolution with some filter <span class="math notranslate nohighlight">\(h\)</span> and linear operators.</p>
</dd>
</dl>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="modeling-knowledge.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Modeling Knowledge</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="denoise-deblur.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Denoising and deblurring</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Ivan Dokmanić<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>